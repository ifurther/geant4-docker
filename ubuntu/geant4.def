Bootstrap: library
#Bootstrap: debootstrap
From:  iifurther/geant4/base:20240904
#OSVersion: jammy
#MirrorURL:  http://tw.archive.ubuntu.com/ubuntu/
Stage: build

%post
#apt-get update
#apt-get -y install wget
#wget https://raw.githubusercontent.com/root-project/root-docker/master/ubuntu2204/packages
#apt-get -y install $(cat packages)
#rm packages

mkdir -p /mcs
cd /mcs
ROOT_BIN=root_v6.32.02.Linux-ubuntu22.04-x86_64-gcc11.4.tar.gz
wget https://root.cern/download/${ROOT_BIN}
tar -xf ${ROOT_BIN}
rm -f /${ROOT_BIN}
#echo /mcs/root/lib >> /etc/ld.so.conf

mkdir -p /mcs/geant4
cd /mcs/geant4
wget https://gitlab.cern.ch/geant4/geant4/-/archive/v11.2.1/geant4-v11.2.1.tar.gz
tar -xf geant4-v11.2.1.tar.gz
mkdir 11.2.1
mkdir build
cd build
cmake -DCMAKE_INSTALL_PREFIX=mcs/geant4/11.2.1-DGEANT4_INSTALL_DATA=OFF \
      -DGEANT4_BUILD_MULTITHREADED=ON -DGEANT4_USE_SYSTEM_ZLIB=ON -DGEANT4_USE_SYSTEM_EXPAT=ON \
      -DGEANT4_USE_QT=ON -DGEANT4_USE_RAYTRACER_X11=ON \
      /mcs/geant4/geant4-v11.2.1
make -j`grep -c ^processor /proc/cpuinfo` &&\
make install

Bootstrap: library
From: iifurther/geant4/base:20240904
Stage: final

%files from build
  /mcs/geant4/11.2.1 /mcs/geant4/11.2.1
  /mcs/root /mcs/root

%post
#apt-get update
#apt-get -y install wget
#wget https://raw.githubusercontent.com/root-project/root-docker/master/ubuntu2204/packages
#apt-get -y install $(cat packages)
#rm packages
#mkdir -p /mcs
#cd /mcs
#ROOT_BIN=root_v6.32.02.Linux-ubuntu22.04-x86_64-gcc11.4.tar.gz
#wget https://root.cern/download/${ROOT_BIN}
#tar -xf ${ROOT_BIN}
#rm -f /${ROOT_BIN}
echo /mcs/root/lib >> /etc/ld.so.conf
ldconfig

%labels
    Version v11.2.1
    OWNER iifurther
%help
    This is a geant4 and root conitaner file
